{% extends 'layout.html' %}

{% block head %}

<!-- Preload gallery images -->
<link rel="preload" href="/static/public/Pao.webp" as="image" type="image/webp">
<link rel="preload" href="/static/public/Manu.webp" as="image" type="image/webp">
<link rel="preload" href="/static/public/Boquita_Still.webp" as="image" type="image/webp">
<link rel="preload" href="/static/public/Gaia.webp" as="image" type="image/webp">
{% endblock %}

{% block body %}
<!-- For mobile: only hero + gallery take viewport height. For desktop: maintains original layout -->
<div class="flex flex-col text-white">
  <!-- Hero + Gallery Container -->
  <div class="relative flex flex-col rounded-xl md:rounded-none
              max-sm:h-[100dvh] 
              sm:h-screen 
              md:h-[700px] bg-black">

    <!-- Hero Section - Simplified structure -->
    <div class="flex flex-col md:flex-row h-full bg-zinc-900 text-white
                max-sm:items-start
                max-sm:rounded-2xl
                overflow-hidden">
      <!-- Mobile Layout -->
      <div class="flex flex-col md:hidden">
        <!-- Hero section -->
        <div class="h-[400px] flex flex-col justify-start px-6 pt-8">
          <h1 class="hero-mobile mb-4">Listamos recursos artísticos <span class="text-indigo-500">globales_</span></h1>
          <p class="text-xl text-gray-300 mb-6 mr-24 tracking-tight">Para artistas, estudiantes, gestores e investigadores de latinoamérica.</p>
          
          <!-- Button aligned left -->
          <a href="{{ url_for('all_pages') }}" 
             class="inline-flex items-center justify-center px-5 py-2.5 
                    bg-indigo-500 hover:bg-indigo-600 
                    text-white font-semibold text-sm
                    rounded-lg transition-all duration-300 ease-in-out
                    transform hover:scale-[1.02] hover:-translate-y-0.5
                    shadow-lg hover:shadow-indigo-500/50
                    w-3/5 mb-8">
            <span class="flex-1 text-center">Entrar</span>
          </a>
        </div>

        <!-- Gallery section -->
        <div class="h-[400px] relative overflow-hidden">
          <div class="gallery-container relative w-full h-full overflow-hidden">
            <picture>
              <source srcset="/static/public/Pao.webp" type="image/webp">
              <img src="/static/public/Pao.png" 
                   alt="Hero Image 1"
                   class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-0 transition-all duration-1500 ease-in-out"
                   width="800"
                   height="600"
                   loading="eager"
                   fetchpriority="high"
                   decoding="async">
            </picture>

            <picture>
              <source srcset="/static/public/Manu.webp" type="image/webp">
              <img src="/static/public/Manu.png" 
                   alt="Hero Image 2"
                   class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                   width="800"
                   height="600"
                   loading="lazy"
                   decoding="async">
            </picture>

            <picture>
              <source srcset="/static/public/Boquita_Still.webp" type="image/webp">
              <img src="/static/public/Boquita_Still.png" 
                   alt="Hero Image 3"
                   class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                   width="800"
                   height="600"
                   loading="lazy"
                   decoding="async">
            </picture>

            <picture>
              <source srcset="/static/public/Gaia.webp" type="image/webp">
              <img src="/static/public/Gaia.png" 
                   alt="Hero Image 4"
                   class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                   width="800"
                   height="600"
                   loading="lazy"
                   decoding="async">
            </picture>
          </div>
        </div>
      </div>

      <!-- Desktop Layout -->
      <div class="hidden md:flex flex-col h-full w-full">
        <div class="flex flex-row flex-grow">
          <!-- First Column - Hero Text -->
          <div class="w-[35%] flex flex-col justify-center px-8 relative 2xl:left-12">
            <h1 class="text-[4.2rem] font-bold leading-[0.9] mb-4">Listamos recursos artísticos <span
                class="text-indigo-500">globales_</span></h1>
            <p class="text-xl text-gray-300 w-2/3">Para artistas, estudiantes, gestores e investigadores latinxs.</p>
          </div>

          <!-- Second Column - Image Gallery -->
          <div class="w-[40%] overflow-hidden relative">
            <div class="gallery-container relative w-full h-full overflow-hidden">
              <picture>
                <source srcset="/static/public/Pao.webp" type="image/webp">
                <img src="/static/public/Pao.png" 
                     alt="Hero Image 1"
                     class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-0 transition-all duration-1500 ease-in-out"
                     width="800"
                     height="600"
                     loading="eager"
                     fetchpriority="high"
                     decoding="async">
              </picture>

              <picture>
                <source srcset="/static/public/Manu.webp" type="image/webp">
                <img src="/static/public/Manu.png" 
                     alt="Hero Image 2"
                     class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                     width="800"
                     height="600"
                     loading="lazy"
                     decoding="async">
              </picture>

              <picture>
                <source srcset="/static/public/Boquita_Still.webp" type="image/webp">
                <img src="/static/public/Boquita_Still.png" 
                     alt="Hero Image 3"
                     class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                     width="800"
                     height="600"
                     loading="lazy"
                     decoding="async">
              </picture>

              <picture>
                <source srcset="/static/public/Gaia.webp" type="image/webp">
                <img src="/static/public/Gaia.png" 
                     alt="Hero Image 4"
                     class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out"
                     width="800"
                     height="600"
                     loading="lazy"
                     decoding="async">
              </picture>
            </div>
          </div>

          <!-- Third Column - What We Offer -->
          <div class="w-[25%] flex flex-col justify-center px-8">
            <!-- Level 1: Primary Heading -->
            <h2 class="text-[1.8rem] font-bold leading-[0.95] mb-4">Informate gratis sobre becas, premios, residencias y encargos.
            </h2>

            <!-- Level 2: Secondary Text -->
            <p class="text-xl text-gray-300 mb-6 pr-12 leading-[1.1] mt-2 -mr-6"><span class="text-indigo-500 font-black mr-1">_</span>busca, guarda y comparte recursos</span> para
              transformar tu carrera internacional <span class="text-indigo-500 font-black">_</span></p>

            <!-- Level 3: Descriptive Text -->
            <p class="text-sm text-gray-400 leading-snug pr-12 mb-8">
              + Oportunidades es un proyecto de la ONG Atlanticx en el marco de la "Digital Public Goods Alliance",
              una propuesta de sostenibilidad de la ONU que busca hacer accesibles datos de impacto público.
            </p>

            <!-- Fixed Button with smaller size -->
            <a href="{{ url_for('all_pages') }}" 
               class="inline-flex items-center justify-center px-5 py-2.5 
                      bg-indigo-500 hover:bg-indigo-600 
                      text-white font-semibold text-sm
                      rounded-lg transition-all duration-300 ease-in-out
                      transform hover:scale-[1.02] hover:-translate-y-0.5
                      shadow-lg hover:shadow-indigo-500/50
                      -mr-12 w-full">
              <span class="flex-1 text-center">Entrar</span>
            </a>
          </div>
        </div>

        <!-- New color row -->
        <div class="flex h-8 w-full">
          <div class="w-[35%] bg-emerald-500"></div>
          <div class="w-[40%] bg-amber-500"></div>
          <div class="w-[25%] bg-rose-500"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer Section - Outside of viewport container -->
  <footer class="w-full z-20 relative max-sm:mt-4">
    {% include 'footer.html' %}
  </footer>
</div>

<!-- Spinner -->
<div id="spinner" class="spinner h-8 w-8">
  <img src="{{ url_for('static', filename='public/spinner.gif') }}" alt="Loading...">
</div>

<style>
  .spinner {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
  }

  .gratis-text {
    font-family: 'Inter', sans-serif;
    font-size: 3.5rem;
    line-height: 0.88;
    color: #6366F1;
    font-weight: 900;
  }

  @media (max-width: 768px) {
    .gratis-text {
      font-size: 3.6rem;
      line-height: 0.88;
      font-weight: 900;
    }
  }

  /* Base styles for hero-text */
  .hero-text {
    font-family: 'Poppins', sans-serif;
    font-size: 3.1rem;
    line-height: 0.88;
    font-weight: 700;
  }

  /* Medium screens */
  @media (min-width: 768px) {
    .hero-text {
      font-size: 2.7rem;
      line-height: 0.95;
      font-weight: 500;
      letter-spacing: -0.05em;
    }
  }

  /* Large screens */
  @media (min-width: 1024px) and (max-width: 1279px) {
    .hero-text {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 3rem;
      line-height: 1;
      font-weight: 600;
    }
  }

  /* Extra large screens */
  @media (min-width: 1280px) {
    .hero-text {
      font-size: 3.7rem;
      line-height: 0.98;
      font-weight: 600;
    }
  }

  .hero-mobile {
    font-family: 'Poppins', sans-serif;
    font-size: 2.5rem;
    line-height: 0.95;
    font-weight: 700;
  }

  /* Small phones (iPhone SE, 6, 7, 8) */
  @media (max-height: 667px) {
    .hero-mobile {
      font-size: 2.5rem;
      line-height: 1;
    }
  }

  @media (min-width: 768px) {
    .hero-mobile {
      font-size: 3.9rem;
      line-height: 0.88;
      font-weight: 500;
    }
  }

  .updates-text {
    font-size: 1rem;
    line-height: 1.5;
    font-weight: 500;
  }

  @media (min-width: 768px) and (max-width: 1023px) {
    .updates-text {
      white-space: nowrap;
      font-size: 0.8rem;
      letter-spacing: -0.01em;
      text-overflow: ellipsis !important;
      white-space: nowrap !important;
      text-align: center !important;
      /* Ensure text is centered */
      width: 100% !important;
      /* Ensure the div takes full width of its parent */
    }

    /* Hide elements between md and lg */
    .counter-md,
    .arrow-md,
    .notification-dot-md,
    .separator-md,
    .updates-text-full {
      display: none;
    }

    /* Show truncated version */
    .updates-text-truncated {
      display: block;
    }
  }

  /* Remove the larger breakpoint styles since we want default behavior after lg */

  @media screen {
    .debug-footer {
      outline: 2px solid red;
      /* This will help us see if styles are loading */
    }
  }

  /* Force footer visibility */
  @media (min-width: 768px) {
    .md\:h-16 {
      height: 4rem !important;
    }
  }

  .gallery-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .gallery-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: translateX(100%);
    transition: transform 1.5s ease-in-out;
    filter: contrast(180%) saturate(180%) brightness(0.7) !important;
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /* Make this rule more specific */
  .gallery-container picture:first-child img {
    transform: translateX(0) !important;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const pictures = Array.from(document.querySelectorAll('.gallery-container picture'));
    let currentIndex = 0;

    function switchImage() {
      const currentPicture = pictures[currentIndex];
      const nextIndex = (currentIndex + 1) % pictures.length;
      const nextPicture = pictures[nextIndex];

      // Get the img elements inside the pictures
      const currentImage = currentPicture.querySelector('img');
      const nextImage = nextPicture.querySelector('img');

      // Apply transforms to the img elements
      currentImage.style.transform = 'translateX(-100%)';
      nextImage.style.transform = 'translateX(0)';

      setTimeout(() => {
        currentImage.style.transform = 'translateX(100%)';
        currentIndex = nextIndex;
      }, 1500);
    }

    // Start the carousel
    setInterval(switchImage, 5000);
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Precarga las siguientes imágenes después de que la primera esté lista
  const preloadNextImages = () => {
    const imageUrls = [
      '/static/public/Manu.webp',
      '/static/public/Boquita_Still.webp',
      '/static/public/Gaia.webp'
    ];
    
    imageUrls.forEach(url => {
      const img = new Image();
      img.src = url;
    });
  };
  
  // Ejecutar después de que la primera imagen esté cargada
  window.addEventListener('load', preloadNextImages);
});
</script>
{% endblock %}
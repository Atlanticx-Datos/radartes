{% extends 'layout.html' %}

{% block head %}
<link rel="preload" href="/static/public/pop1.mp4" as="video" type="video/mp4">
{% endblock %}

{% block body %}
<div class="w-full max-w-[1350px] mx-auto px-3 md:px-8">
  <!-- Main Content Section - Simplified height management -->
  <div class="relative bg-black text-white flex flex-col rounded-xl md:rounded-none
              min-h-screen md:h-[600px]"> <!-- Simplified height control -->

    <!-- Navigation for Index Page -->
    <nav class="absolute 
                -top-6
                right-5
                z-[100] flex items-center justify-between w-full px-4">
      <!-- Logo for larger screens -->
      <div class="hidden md:block">
        <img src="/static/public/LogoCienOpps.png" alt="Logo" class="h-16">
      </div>
      <div class="ml-auto dropdown dropdown-bottom relative left-8 md:left-8 dropdown-end bottom-8 md:-top-11">
        <div tabindex="0" role="button" class="relative group">
          <div class="relative">
            <span class="flex items-center justify-center w-10 h-10 
            bg-gradient-to-br from-zinc-700/80 to-zinc-900/95 
            rounded-full transition-all duration-300 
            group-hover:from-zinc-600/90 group-hover:to-zinc-900/95
            group-hover:scale-105">
              <svg class="w-5 h-5 text-white transition-transform duration-300 
                          group-hover:rotate-180" data-slot="icon" fill="currentColor" viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path
                  d="M10 3a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM10 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM11.5 15.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z" />
              </svg>
            </span>
            <span class="absolute top-0 right-0 flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
            </span>
          </div>
        </div>
        <ul tabindex="0"
          class="dropdown-content z-[1] menu p-2 bg-base-100 rounded-md w-52 border border-black border-4 mt-3 text-black bg-gray-200">
          <li>
            <a href="{{ url_for('all_pages') }}" onclick="showSpinner(event)">
              <span class="border-l-4 border-accent pl-3 uppercase font-semibold">Oportunidades</span>
            </a>
          </li>
          <li>
            <a href="{{ url_for('list_saved_opportunities') }}" onclick="showSpinner(event)">
              <span class="border-l-4 border-secondary pl-3 uppercase font-semibold">Guardadas</span>
            </a>
          </li>
          <li>
            <a href="{{ url_for('index') }}">
              <span class="border-l-4 border-black pl-3 uppercase font-semibold">Home</span>
            </a>
          </li>
          {% if session.get('user') %}
          <li>
            <a href="https://github.com/Atlanticx-Datos/100_Oportunidades" target="_blank" rel="noopener noreferrer">
              <span class="border-l-4 border-primary pl-3 uppercase font-semibold">GitHub</span>
            </a>
          </li>
          <li>
            <a href="{{ url_for('logout') }}">
              <span class="border-l-4 border-base-200 pl-3 uppercase font-semibold">Cerrar</span>
            </a>
          </li>
          {% endif %}
        </ul>
      </div>
    </nav>

    <!-- Hero Section - Simplified structure -->
    <div class="flex flex-col md:flex-row h-full bg-zinc-900 text-white">
      <!-- Mobile Layout - Now uses full height -->
      <div class="flex flex-col h-full md:hidden">
        <div class="flex-1 flex flex-col justify-center px-6 pt-16"> <!-- Added pt-16 for nav spacing -->
          <h1 class="hero-mobile mb-4">Your Hero Message</h1>
          <p class="text-xl">Brief description or tagline.</p>
        </div>

        <div class="flex-1 relative overflow-hidden">
          <div class="gallery-container relative w-full h-full overflow-hidden">
            <img src="/static/public/Pao.png" alt="Hero Image 1"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-0 transition-all duration-1500 ease-in-out">
            <img src="/static/public/Manu.png" alt="Hero Image 2"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
            <img src="/static/public/Boquita_Still.png" alt="Hero Image 3"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
            <img src="/static/public/Gaia.png" alt="Hero Image 4"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
          </div>
        </div>
      </div>

      <!-- Desktop Layout - Simplified -->
      <div class="hidden md:flex md:flex-row h-full w-full">
        <!-- First Column - Hero Text -->
        <div class="w-[35%] flex flex-col justify-center px-8">
          <h1 class="text-[4.2rem] font-bold leading-[0.9] mb-4">Más recursos <span
              class="text-indigo-500">globales</span></h1>
          <p class="text-xl text-gray-300 mr-12">Para artistas, gestores e investigadores latinxs.</p>
        </div>

        <!-- Second Column - Image Gallery (moved from third to second position) -->
        <div class="w-[40%] overflow-hidden relative">
          <div class="gallery-container relative w-full h-full overflow-hidden">
            <img src="/static/public/Pao.png" alt="Hero Image 1"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-0 transition-all duration-1500 ease-in-out">
            <img src="/static/public/Manu.png" alt="Hero Image 2"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
            <img src="/static/public/Boquita_Still.png" alt="Hero Image 3"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
            <img src="/static/public/Gaia.png" alt="Hero Image 4"
              class="gallery-image absolute top-0 left-0 w-full h-full object-cover transform translate-x-full transition-all duration-1500 ease-in-out">
          </div>
        </div>

        <!-- Third Column - What We Offer (with hierarchical structure) -->
        <div class="w-[25%] flex flex-col justify-center px-8">
          <!-- Level 1: Primary Heading -->
          <h2 class="text-[2rem] font-bold leading-[0.95] mb-4 -mr-12">Informate gratis sobre becas, premios, residencias y encargos.
          </h2>

          <!-- Level 2: Secondary Text -->
          <p class="text-xl text-gray-300 mb-6 pr-12 leading-[1.1] mt-2 -mr-12">Busca, guarda y comparte recursos para
            transformar tu carrera internacional</p>

          <!-- Level 3: Descriptive Text -->
          <p class="text-sm text-gray-400 leading-snug pr-12 mb-8">
            + Oportunidades es un proyecto de la ONG Atlanticx en el marco de la "Digital Public Goods Alliance",
            una propuesta de sostenibilidad de la ONU que busca hacer accesibles datos de impacto público.
          </p>

          <!-- Fixed Button with smaller size -->
          <a href="{{ url_for('all_pages') }}" 
             class="inline-flex items-center justify-center px-5 py-2.5 
                    bg-indigo-500 hover:bg-indigo-600 
                    text-white font-semibold text-base
                    rounded-lg transition-all duration-300 ease-in-out
                    transform hover:scale-[1.02] hover:-translate-y-0.5
                    shadow-lg hover:shadow-indigo-500/50
                    -mr-12 w-fit">
            Entrar
            <svg class="w-4 h-4 ml-2 -mr-1 transform rotate-[-45deg]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
            </svg>
          </a>
        </div>
      </div>
    </div>

    <!-- Services Section - Adjusted positioning -->
    <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-[95%] z-10">
      <div class="grid grid-cols-2 md:grid-cols-12 min-h-[3.5rem] gap-0 overflow-visible 
                  ring-8 ring-zinc-800 rounded-lg">
        <!-- Add Opportunity Column -->
        <div
          class="hidden md:flex bg-indigo-500/90 hover:bg-indigo-600/90 col-span-1 md:col-span-3 items-center justify-center p-4 md:p-3 group transition-all duration-300 rounded-l-lg relative z-20">
          <a href="https://atlanticxx.notion.site/1509dd874b3a80a5ac8bce88f0d1bde3?pvs=105" target="_blank"
            class="flex items-center space-x-2 text-center">
            <span class="updates-text text-white">Sumá tu convocatoria</span>
            <svg
              class="w-5 h-5 transform rotate-[-45deg] transition-transform group-hover:-translate-y-0.5 group-hover:translate-x-0.5 text-white">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19l14-14m0 0h-9m9 0v9" />
            </svg>
          </a>
        </div>

        <!-- Updates Column -->
        <div
          class="hidden md:flex bg-zinc-900/95 col-span-1 md:col-span-8 items-center justify-center py-2 md:py-0 px-6 relative z-20">
          <div class="flex items-center space-x-4">
            <div class="relative flex items-center">
              {% if total_nuevas > 1 %}
              <span class="bg-indigo-500 text-white px-2 py-1 rounded-full text-xs font-bold absolute -top-3 -right-3">
                +{{ total_nuevas }}
              </span>
              {% endif %}
            </div>
            <div class="flex items-center justify-center">
              <span class="updates-text text-gray-200">
                <span class="mr-2"></span>
                <span>Nuevas becas, premios, convocatorias y residencias.</span>
              </span>
            </div>
          </div>
        </div>

        <!-- Social Media Column -->
        <div
          class="bg-indigo-400/90 col-span-2 md:col-span-1 flex items-center justify-center p-4 md:p-3 rounded-xl md:rounded-l-none md:rounded-r-lg relative z-20">
          <div class="flex space-x-6 md:space-x-2">
            <a href="mailto:your@email.com"
              class="text-white hover:text-indigo-100 transition-all duration-300 hover:-translate-y-1">
              <svg class="w-6 h-6 md:w-4 md:h-4 lg:w-5 lg:h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z" />
                <path
                  d="M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z" />
              </svg>
            </a>
            <a href="#" class="text-white hover:text-indigo-100 transition-all duration-300 cursor-default opacity-75"
              aria-disabled="true" title="Instagram account coming soon!">
              <svg class="w-5 h-5 md:w-3 md:h-3 lg:w-4 lg:h-4 scale-110 relative top-[1.5px]" fill="currentColor"
                viewBox="0 0 24 24">
                <path fill-rule="evenodd"
                  d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z"
                  clip-rule="evenodd" />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer Section - Positioned relative to main content -->
    <div class="w-full z-20 relative">
      {% include 'footer.html' %}
    </div>
  </div>

  <!-- Spinner -->
  <div id="spinner" class="spinner h-8 w-8">
    <img src="{{ url_for('static', filename='public/spinner.gif') }}" alt="Loading...">
  </div>

  <style>
    .spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
    }

    .gratis-text {
      font-family: 'Inter', sans-serif;
      font-size: 3.5rem;
      line-height: 0.88;
      color: #6366F1;
      font-weight: 900;
    }

    @media (max-width: 768px) {
      .gratis-text {
        font-size: 3.6rem;
        line-height: 0.88;
        font-weight: 900;
      }
    }

    /* Base styles for hero-text */
    .hero-text {
      font-family: 'Poppins', sans-serif;
      font-size: 3.1rem;
      line-height: 0.88;
      font-weight: 700;
    }

    /* Medium screens */
    @media (min-width: 768px) {
      .hero-text {
        font-size: 2.7rem;
        line-height: 0.95;
        font-weight: 500;
        letter-spacing: -0.05em;
      }
    }

    /* Large screens */
    @media (min-width: 1024px) and (max-width: 1279px) {
      .hero-text {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 3rem;
        line-height: 1;
        font-weight: 600;
      }
    }

    /* Extra large screens */
    @media (min-width: 1280px) {
      .hero-text {
        font-size: 3.7rem;
        line-height: 0.98;
        font-weight: 600;
      }
    }

    .hero-mobile {
      font-family: 'Poppins', sans-serif;
      font-size: 3.1rem;
      line-height: 1;
      font-weight: 700;
    }

    /* Small phones (iPhone SE, 6, 7, 8) */
    @media (max-height: 667px) {
      .hero-mobile {
        font-size: 2.5rem;
        line-height: 1;
      }
    }

    @media (min-width: 768px) {
      .hero-mobile {
        font-size: 3.9rem;
        line-height: 0.88;
        font-weight: 500;
      }
    }

    .updates-text {
      font-size: 1rem;
      line-height: 1.5;
      font-weight: 500;
    }

    @media (min-width: 768px) and (max-width: 1023px) {
      .updates-text {
        white-space: nowrap;
        font-size: 0.8rem;
        letter-spacing: -0.01em;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
        text-align: center !important;
        /* Ensure text is centered */
        width: 100% !important;
        /* Ensure the div takes full width of its parent */
      }

      /* Hide elements between md and lg */
      .counter-md,
      .arrow-md,
      .notification-dot-md,
      .separator-md,
      .updates-text-full {
        display: none;
      }

      /* Show truncated version */
      .updates-text-truncated {
        display: block;
      }
    }

    /* Remove the larger breakpoint styles since we want default behavior after lg */

    @media screen {
      .debug-footer {
        outline: 2px solid red;
        /* This will help us see if styles are loading */
      }
    }

    /* Force footer visibility */
    @media (min-width: 768px) {
      .md\:h-16 {
        height: 4rem !important;
      }
    }

    .gallery-container {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .gallery-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transform: translateX(100%);
      transition: transform 1.5s ease-in-out;
      filter: contrast(180%) saturate(180%) brightness(0.7) !important;
      will-change: transform;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }

    /* Make this rule more specific */
    .gallery-container .gallery-image:first-child {
      transform: translateX(0) !important;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const images = Array.from(document.querySelectorAll('.gallery-image'));
      let currentIndex = 0;

      function switchImage() {
        const currentImage = images[currentIndex];
        const nextIndex = (currentIndex + 1) % images.length;
        const nextImage = images[nextIndex];

        // Instead of using classList, let's try direct style manipulation
        currentImage.style.transform = 'translateX(-100%)';
        nextImage.style.transform = 'translateX(0)';

        setTimeout(() => {
          currentImage.style.transform = 'translateX(100%)';
          currentIndex = nextIndex;
        }, 1500);
      }

      // Start the carousel
      setInterval(switchImage, 5000);
    });
  </script>
  {% endblock %}